# Copyright 2018 The Knative Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.

# This is the meta config file for Prow Jobs in all Knative projects.
# Run `make config` after making changes to this file, the config-generator
# will generate Prow jobs for you in jobs/config.yaml.

# toplevel contains repo top level settings:
# - go-coverage set to true meas presubmit, postsubmit, and continuous coverage
#   jobs available
# toplevels:
#   - repo: "knative/serving"
#     go-coverage: true
#   - repo: "google/knative-gcp"
#     go-coverage: true
#   - repo: "knative-sandbox/eventing-kafka"
#     go-coverage: true
#   - repo: "knative-sandbox/operator"
#     go-coverage: true
#   - repo: "knative/caching"
#     go-coverage: true
#   - repo: "knative/client"
#     go-coverage: true
#   - repo: "knative/client-contrib"
#     go-coverage: true
#   - repo: "knative/docs"
#     go-coverage: true
#   - repo: "knative/eventing"
#     go-coverage: true
#   - repo: "knative/eventing-operator"
#     go-coverage: true
#   - repo: "knative/net-certmanager"
#     go-coverage: true
#   - repo: "knative/net-contour"
#     go-coverage: true
#   - repo: "knative/net-http01"
#     go-coverage: true
#   - repo: "knative/net-istio"
#     go-coverage: true
#   - repo: "knative/net-kourier"
#     go-coverage: true
#   - repo: "knative/pkg"
#     go-coverage: true
#   - repo: "knative/serving-operator"
#     go-coverage: true
#   - repo: "knative/test-infra"
#     go-coverage: true

presubmits:
  - repo: "*"
    jobs:
      - type: "*"
        template: "prow_presubmit_job"
        command: "./test/presubmit-tests.sh"
      - type: build-tests
        always-run: true
        optional: false
        args:
        - "--build-tests"
      - type: unit-tests
        always-run: true
        optional: false
        args:
        - "--unit-tests"
      - type: integration-tests
        always-run: true
        optional: false
        args:
        - "--integration-tests"
      - type: go-coverage
        template: "prow_presubmit_gocoverate_job"
        go-coverage-threshold: 50
        always-run: true
      - type: custom-job
        template: "prow_presubmit_custom_job.yaml"
        
  - repo: knative/serving
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        performance: true
      - type: build-tests
        resources:
          requests:
            memory: 12Gi # Real request for this pod is 16 as sidecar requests 4
          limits:
            memory: 16Gi
      - type: unit-tests
        needs-monitor: true
      - type: integration-tests
        needs-monitor: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh"
      - type: custom-test
        name: upgrade-tests
        always-run: true
        optional: false
        needs-monitor: true
        args:
        - "--run-test"
        - "./test/e2e-upgrade-tests.sh"
      - type: custom-test
        name: autotls-tests
        always-run: true
        optional: false
        needs-monitor: true
        args:
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh"
      - type: go-coverage
        always-run: true
        go-coverage-threshold: 80
      - type: custom-test
        name: istio-1.5-mesh
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.5-latest --mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.5-latest --mesh"
      - type: custom-test
        name: istio-1.5-no-mesh
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.5-latest --no-mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.5-latest --no-mesh"
      - type: custom-test
        name: istio-1.4-mesh
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.4-latest --mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.4-latest --mesh"
      - type: custom-test
        name: istio-1.4-no-mesh
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.4-latest --no-mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.4-latest --no-mesh"
      - type: custom-test
        name: gloo-0.17.1
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --gloo-version 0.17.1"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --gloo-version 0.17.1"
      - type: custom-test
        name: kourier-stable
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --kourier-version stable"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --kourier-version stable"
      - type: custom-test
        name: contour-latest
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --contour-version latest"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --contour-version latest"
      - type: custom-test
        name: ambassador-latest
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --ambassador-version latest"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --ambassador-version latest"
      - type: custom-test
        name: https
        always-run: false
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --https"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --https"
      - type: custom-test
        name: build-tests-go114
        always-run: false
        optional: true
        go114: true
        resources:
          requests:
            memory: 12Gi # Real request for this pod is 16 as sidecar requests 4
          limits:
            memory: 16Gi
        args:
          - "--build-tests"
      - type: custom-test
        name: integration-tests-go114
        always-run: false
        optional: true
        go114: true
        args:
          - "--run-test"
          - "./test/e2e-tests.sh"

  - repo: knative/client
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: integration-tests-latest-release
        always-run: true
        command: "./test/presubmit-integration-tests-latest-release.sh"

  - repo: knative/client-contrib
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests

  - repo: knative/eventing
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        performance: true
        go112-branches:
        - release-0.10
      - type: build-tests
        resources:
          requests:
            memory: 12Gi # Real request for this pod is 16 as sidecar requests 4
          limits:
            memory: 16Gi
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/eventing-contrib
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/docs
    jobs:
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
        needs-dind: true
      - type: go-coverage
        always-run: true
      - type: custom-test
        name: markdown-link-check
        always-run: true
        optional: true
        command: "./test/presubmit-link-check.sh"

  - repo: knative/pkg
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/test-infra
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: check-config
        always-run: true
        command: "./test/presubmit-config-check.sh"

  - repo: knative/caching
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/observability
    jobs:
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests

  - repo: knative/sample-controller
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests

  - repo: knative/sample-source
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests

  - repo: google/knative-gcp
    jobs:
      - type: repo-settings
        performance: true
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
        args:
        - "--run-test"
        - "./test/e2e-tests.sh"
      - type: custom-test
        name: wi-tests
        always-run: true
        args:
        - "--run-test"
        - "./test/e2e-wi-tests.sh"
      - type: go-coverage

  - repo: knative/net-certmanager
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/net-contour
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/net-http01
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/net-istio
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: latest
        always-run: true
        optional: true
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version latest"

  - repo: knative/net-kourier
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

  - repo: knative/serving-operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: upgrade-tests
        always-run: true
        args:
          - "--run-test"
          - "./test/e2e-upgrade-tests.sh"

  - repo: knative/eventing-operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: repo-settings
        go112-branches:
        - release-0.10
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: upgrade-tests
        always-run: true
        args:
          - "--run-test"
          - "./test/e2e-upgrade-tests.sh"

  - repo: knative/website
    jobs:
      # This repo only uses Tide
      - type: repo-settings
      # No need of any of these
      # - type: build-tests: false
      # - type: unit-tests: false
      # - type: integration-tests: false
      # - type: go-coverage: false

  - repo: knative/community

  - repo: knative-sandbox/operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage
      - type: custom-test
        name: upgrade-tests
        always-run: true
        args:
          - "--run-test"
          - "./test/e2e-upgrade-tests.sh"

  - repo: knative-sandbox/eventing-kafka
    jobs:
      - type: "*"
        dot-dev: true
      - type: build-tests
      - type: unit-tests
      - type: integration-tests
      - type: go-coverage

postsubmits:
  - repo: "*"
    jobs:
      - type: "go-coverage"
        template: "prow_postsubmit_gocoverage_job"

periodics:
  - repo: "*"
    jobs:
      - type: "*"
        timeout: 90
        needs-monitor: true
        template: "prow_periodic_test_job.yaml"
      - type: continuous
        command: "./test/presubmit-tests.sh"
        args:
          - "--all-tests"
      - type: branch-ci
        name: continuous
        timeout: 180
        needs-dind: true
        command: "./hack/release.sh"
        args:
          - "--nopublish"
          - "--notag-release"
      - type: nightly-release
        command: "./hack/release.sh"
        args:
          - "--publish"
          - "--tag-release"
      - type: auto-release
        command: "./hack/release.sh"
      - type: dot-release
        command: "./hack/release.sh"
      - type: custom-job
        timeout: 100
      - type: go-coverage
        template: "prow_periodic_custom_go_coverage.yaml"
        command: "/coverage"

  - repo: knative/serving
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        timeout: 100
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: branch-ci
        release: "0.10"
        go113: true
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: custom-job
        name: istio-1.5-mesh
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.5-latest --mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.5-latest --mesh"
        go113: true
      - type: custom-job
        name: istio-1.5-no-mesh
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.5-latest --no-mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.5-latest --no-mesh"
        go113: true
      - type: custom-job
        name: istio-1.4-mesh
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.4-latest --mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.4-latest --mesh"
        go113: true
      - type: custom-job
        name: istio-1.4-no-mesh
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --istio-version 1.4-latest --no-mesh"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --istio-version 1.4-latest --no-mesh"
        go113: true
      - type: custom-job
        name: gloo-0.17.1
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --gloo-version 0.17.1"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --gloo-version 0.17.1"
        go113: true
      - type: custom-job
        name: kourier-stable
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --kourier-version stable"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --kourier-version stable"
        go113: true
      - type: custom-job
        name: contour-latest
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --contour-version latest"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --contour-version latest"
        go113: true
      - type: custom-job
        name: ambassador-latest
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --ambassador-version latest"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --ambassador-version latest"
        go113: true
      - type: custom-job
        name: https
        command: "./test/presubmit-tests.sh"
        args:
        - "--run-test"
        - "./test/e2e-tests.sh --https"
        - "--run-test"
        - "./test/e2e-auto-tls-tests.sh --https"
        go113: true
      - type: nightly-release
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.10"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.10"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/serving"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: webhook-apicoverage
        go113: true
        timeout: 100
        command: "./test/apicoverage.sh"
      - type: custom-job
        name: continuous-go114
        command: "./test/e2e-tests.sh"
        timeout: 100
        dot-dev: true
        go114: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi

  - repo: knative/client
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
      - type: custom-job
        name: tekton
        # This job must run after the nightly job so it uses the latest nightly.
        # Nightly jobs run between 1AM and 3AM PST.
        # Run this job at 5AM PST (1PM UTC)
        cron: "0 13 * * *"
        command: "./test/tekton-tests.sh"
        go113: true
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/client"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/client"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/client"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/client"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        go113: true

  - repo: knative/client-contrib
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/docs
    jobs:
      - type: continuous
        needs-dind: true

  - repo: knative/eventing
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        timeout: 90
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: branch-ci
        release: "0.10"
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.10"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.10"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/eventing"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi

  - repo: knative/eventing-contrib
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: branch-ci
        release: "0.10"
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.10"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-contrib"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.10"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-contrib"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-contrib"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-contrib"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/eventing-contrib"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        resources:
          requests:
            memory: 12Gi
          limits:
            memory: 16Gi

  - repo: knative/pkg
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/caching
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/observability
    jobs:
      - type: continuous
        go113: true

  - repo: knative/sample-controller
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/sample-source
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/test-infra
    jobs:
      - type: continuous
        dot-dev: true
        go113: true

  - repo: knative/serving-operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/serving-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/serving-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative/eventing-operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: branch-ci
        release: "0.11"
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        release: "0.11"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.11"
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/eventing-operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: google/knative-gcp
    jobs:
      - type: continuous
        go113: true
      - type: branch-ci
        release: "0.12"
        go113: true
      - type: branch-ci
        release: "0.13"
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        release: "0.12"
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/knative-gcp"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
          - "--branch release-0.12"
        env-vars:
        - ORG_NAME=google
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/knative-gcp"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=google
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/knative-gcp"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=google

  - repo: knative/net-certmanager
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/net-certmanager"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/net-certmanager"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative/net-contour
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/net-contour"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/net-contour"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative/net-http01
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/net-http01"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/net-http01"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative/net-istio
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/net-istio"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/net-istio"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative/net-kourier
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/net-kourier"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/net-kourier"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"

  - repo: knative-sandbox/operator
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=knative-sandbox
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/operator"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=knative-sandbox

  - repo: knative-sandbox/eventing-kafka
    jobs:
      - type: "*"
        dot-dev: true
      - type: continuous
        go113: true
      - type: nightly-release
        go113: true
      - type: dot-release
        go113: true
        args:
          - "--dot-release"
          - "--release-gcs knative-releases/eventing-kafka"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=knative-sandbox
      - type: auto-release
        go113: true
        command: "./hack/release.sh"
        args:
          - "--auto-release"
          - "--release-gcs knative-releases/eventing-kafka"
          - "--release-gcr gcr.io/knative-releases"
          - "--github-token /etc/hub-token/token"
        env-vars:
        - ORG_NAME=knative-sandbox
