# Copyright 2019 The Knative Authors
#
# Licensed under the Apache License, Version 2.0 (the "License");
# you may not use this file except in compliance with the License.
# You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
# ############################################################
# ####                                                    ####
# #### THIS FILE IS AUTOMATICALLY GENERATED. DO NOT EDIT. ####
# ####     USE "make config" TO REGENERATE THIS FILE.     ####
# ####                                                    ####
# ############################################################
plank:
  job_url_template: 'https://gubernator.knative.dev/build/knative-prow/{{if or (eq .Spec.Type "presubmit") (eq .Spec.Type "batch")}}pr-logs/pull{{with .Spec.Refs}}/{{.Org}}_{{.Repo}}{{end}}{{else}}logs{{end}}{{if eq .Spec.Type "presubmit"}}/{{with index .Spec.Refs.Pulls 0}}{{.Number}}{{end}}{{else if eq .Spec.Type "batch"}}/batch{{end}}/{{.Spec.Job}}/{{.Status.BuildID}}/'
  report_template: '[Full PR test history](https://gubernator.knative.dev/pr/{{.Spec.Refs.Org}}_{{.Spec.Refs.Repo}}/{{with index .Spec.Refs.Pulls 0}}{{.Number}}{{end}}). [Your PR dashboard](https://gubernator.knative.dev/pr/{{with index .Spec.Refs.Pulls 0}}{{.Author}}{{end}}).'
  pod_pending_timeout: 60m
  default_decoration_config:
    timeout: 7200000000000 # 2h
    grace_period: 15000000000 # 15s
    utility_images:
      clonerefs: "gcr.io/k8s-prow/clonerefs@sha256:b62ba1f379ac19c5ec9ee7bcab14d3f0b3c31cea9cdd4bc491e98e2c5f346c07"
      initupload: "gcr.io/k8s-prow/initupload@sha256:58f89f2aae68f7dc46aaf05c7e8204c4f26b53ec9ce30353d1c27ce44a60d121"
      entrypoint: "gcr.io/k8s-prow/entrypoint:v20180512-0255926d1"
      sidecar: "gcr.io/k8s-prow/sidecar@sha256:8807b2565f4d2699920542fcf890878824b1ede4198d7ff46bca53feb064ed44"
    gcs_configuration:
      bucket: "knative-prow"
      path_strategy: "explicit"
    gcs_credentials_secret: "test-account"
prowjob_namespace: default
pod_namespace: test-pods
log_level: info
branch-protection:
  orgs:
    knative:
      # Protect all branches in knative
      # This means all prow jobs with "always_run" set are required
      # to pass before tide can merge the PR.
      # Currently this is manually enabled by the knative org admins,
      # but it's stated here for documentation and reference purposes.
      protect: true
      # Admins can overrule checks
      enforce_admins: false
tide:
  queries:
  - repos:
    - knative/build
    - knative/build-pipeline
    - knative/build-templates
    - knative/observability
    - knative/serving
    - knative/eventing
    - knative/eventing-sources
    - knative/docs
    - knative/test-infra
    - knative/pkg
    - knative/caching
    - knative/website
    labels:
    - lgtm
    - approved
    missingLabels:
    - do-not-merge/hold
    - do-not-merge/work-in-progress
  merge_method:
    knative: squash
    knative/build-pipeline: rebase
  target_url: https://prow.knative.dev/tide
presubmits:
  knative/serving:
  - name: pull-knative-serving-build-tests
    agent: kubernetes
    context: pull-knative-serving-build-tests
    always_run: true
    rerun_command: "/test pull-knative-serving-build-tests"
    trigger: "(?m)^/test (all|pull-knative-serving-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-serving-unit-tests
    agent: kubernetes
    context: pull-knative-serving-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-serving-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-serving-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-serving-integration-tests
    agent: kubernetes
    context: pull-knative-serving-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-serving-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-serving-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--run-test"
        - "./test/e2e-tests.sh"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-serving-upgrade-tests
    agent: kubernetes
    context: pull-knative-serving-upgrade-tests
    always_run: true
    rerun_command: "/test pull-knative-serving-upgrade-tests"
    trigger: "(?m)^/test (all|pull-knative-serving-upgrade-tests),?(\\s+|$)"
    skip_branches:
    - "release-0.1"
    - "release-0.2"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--run-test"
        - "./test/e2e-upgrade-tests.sh"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-serving-go-coverage
    agent: kubernetes
    context: pull-knative-serving-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-serving-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-serving-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/serving.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-serving-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=80"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  - name: pull-knative-serving-go-coverage-dev
    agent: kubernetes
    context: pull-knative-serving-go-coverage-dev
    always_run: false
    rerun_command: "/test pull-knative-serving-go-coverage-dev"
    trigger: "(?m)^/test (pull-knative-serving-go-coverage-dev),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/serving.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage-dev:latest-dev
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-serving-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=80"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  - name: pull-knative-serving-perf-tests
    agent: kubernetes
    context: pull-knative-serving-perf-tests
    always_run: false
    rerun_command: "/test pull-knative-serving-perf-tests"
    trigger: "(?m)^/test (all|pull-knative-serving-perf-tests),?(\\s+|$)"
    skip_branches:
    - "release-0.1"
    - "release-0.2"
    - "release-0.3"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/performance-tests.sh"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  knative/build:
  - name: pull-knative-build-build-tests
    agent: kubernetes
    context: pull-knative-build-build-tests
    always_run: true
    rerun_command: "/test pull-knative-build-build-tests"
    trigger: "(?m)^/test (all|pull-knative-build-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-unit-tests
    agent: kubernetes
    context: pull-knative-build-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-build-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-build-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-integration-tests
    agent: kubernetes
    context: pull-knative-build-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-build-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-build-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        securityContext:
          privileged: true
        volumeMounts:
        - name: docker-graph
          mountPath: /docker-graph
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: DOCKER_IN_DOCKER_ENABLED
          value: "true"
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: docker-graph
        emptyDir: {}
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-go-coverage
    agent: kubernetes
    context: pull-knative-build-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-build-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-build-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/build.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-build-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=80"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/build-pipeline:
  - name: pull-knative-build-pipeline-build-tests
    agent: kubernetes
    context: pull-knative-build-pipeline-build-tests
    always_run: true
    rerun_command: "/test pull-knative-build-pipeline-build-tests"
    trigger: "(?m)^/test (all|pull-knative-build-pipeline-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-pipeline-unit-tests
    agent: kubernetes
    context: pull-knative-build-pipeline-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-build-pipeline-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-build-pipeline-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-pipeline-integration-tests
    agent: kubernetes
    context: pull-knative-build-pipeline-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-build-pipeline-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-build-pipeline-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-pipeline-go-coverage
    agent: kubernetes
    context: pull-knative-build-pipeline-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-build-pipeline-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-build-pipeline-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/build-pipeline.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-build-pipeline-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/eventing:
  - name: pull-knative-eventing-build-tests
    agent: kubernetes
    context: pull-knative-eventing-build-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-build-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-unit-tests
    agent: kubernetes
    context: pull-knative-eventing-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-integration-tests
    agent: kubernetes
    context: pull-knative-eventing-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-go-coverage
    agent: kubernetes
    context: pull-knative-eventing-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-eventing-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-eventing-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/eventing.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-eventing-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/eventing-sources:
  - name: pull-knative-eventing-sources-build-tests
    agent: kubernetes
    context: pull-knative-eventing-sources-build-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-sources-build-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-sources-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-sources-unit-tests
    agent: kubernetes
    context: pull-knative-eventing-sources-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-sources-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-sources-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-sources-integration-tests
    agent: kubernetes
    context: pull-knative-eventing-sources-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-eventing-sources-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-eventing-sources-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-eventing-sources-go-coverage
    agent: kubernetes
    context: pull-knative-eventing-sources-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-eventing-sources-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-eventing-sources-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/eventing-sources.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-eventing-sources-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/docs:
  - name: pull-knative-docs-build-tests
    agent: kubernetes
    context: pull-knative-docs-build-tests
    always_run: true
    rerun_command: "/test pull-knative-docs-build-tests"
    trigger: "(?m)^/test (all|pull-knative-docs-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-docs-unit-tests
    agent: kubernetes
    context: pull-knative-docs-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-docs-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-docs-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-docs-integration-tests
    agent: kubernetes
    context: pull-knative-docs-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-docs-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-docs-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-docs-go-coverage
    agent: kubernetes
    context: pull-knative-docs-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-docs-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-docs-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/docs.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-docs-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/build-templates:
  - name: pull-knative-build-templates-build-tests
    agent: kubernetes
    context: pull-knative-build-templates-build-tests
    always_run: true
    rerun_command: "/test pull-knative-build-templates-build-tests"
    trigger: "(?m)^/test (all|pull-knative-build-templates-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-templates-unit-tests
    agent: kubernetes
    context: pull-knative-build-templates-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-build-templates-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-build-templates-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-build-templates-integration-tests
    agent: kubernetes
    context: pull-knative-build-templates-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-build-templates-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-build-templates-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  knative/pkg:
  - name: pull-knative-pkg-build-tests
    agent: kubernetes
    context: pull-knative-pkg-build-tests
    always_run: true
    rerun_command: "/test pull-knative-pkg-build-tests"
    trigger: "(?m)^/test (all|pull-knative-pkg-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-pkg-unit-tests
    agent: kubernetes
    context: pull-knative-pkg-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-pkg-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-pkg-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-pkg-integration-tests
    agent: kubernetes
    context: pull-knative-pkg-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-pkg-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-pkg-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-pkg-go-coverage
    agent: kubernetes
    context: pull-knative-pkg-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-pkg-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-pkg-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/pkg.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-pkg-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
  knative/test-infra:
  - name: pull-knative-test-infra-build-tests
    agent: kubernetes
    context: pull-knative-test-infra-build-tests
    always_run: true
    rerun_command: "/test pull-knative-test-infra-build-tests"
    trigger: "(?m)^/test (all|pull-knative-test-infra-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-test-infra-unit-tests
    agent: kubernetes
    context: pull-knative-test-infra-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-test-infra-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-test-infra-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-test-infra-integration-tests
    agent: kubernetes
    context: pull-knative-test-infra-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-test-infra-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-test-infra-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  knative/caching:
  - name: pull-knative-caching-build-tests
    agent: kubernetes
    context: pull-knative-caching-build-tests
    always_run: true
    rerun_command: "/test pull-knative-caching-build-tests"
    trigger: "(?m)^/test (all|pull-knative-caching-build-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--build-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-caching-unit-tests
    agent: kubernetes
    context: pull-knative-caching-unit-tests
    always_run: true
    rerun_command: "/test pull-knative-caching-unit-tests"
    trigger: "(?m)^/test (all|pull-knative-caching-unit-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--unit-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-caching-integration-tests
    agent: kubernetes
    context: pull-knative-caching-integration-tests
    always_run: true
    rerun_command: "/test pull-knative-caching-integration-tests"
    trigger: "(?m)^/test (all|pull-knative-caching-integration-tests),?(\\s+|$)"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/prow-tests:stable
        imagePullPolicy: Always
        args:
        - "--scenario=kubernetes_execute_bazel"
        - "--clean"
        - "--job=$(JOB_NAME)"
        - "--repo=github.com/$(REPO_OWNER)/$(REPO_NAME)=$(PULL_REFS)"
        - "--root=/go/src"
        - "--service-account=/etc/test-account/service-account.json"
        - "--upload=gs://knative-prow/pr-logs"
        - "--" # end bootstrap args, scenario args below
        - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
        - "./test/presubmit-tests.sh"
        - "--integration-tests"
        volumeMounts:
        - name: test-account
          mountPath: /etc/test-account
          readOnly: true
        env:
        - name: GOOGLE_APPLICATION_CREDENTIALS
          value: /etc/test-account/service-account.json
        - name: E2E_CLUSTER_REGION
          value: us-west1
      volumes:
      - name: test-account
        secret:
          secretName: test-account
  - name: pull-knative-caching-go-coverage
    agent: kubernetes
    context: pull-knative-caching-go-coverage
    always_run: true
    rerun_command: "/test pull-knative-caching-go-coverage"
    trigger: "(?m)^/test (all|pull-knative-caching-go-coverage),?(\\s+|$)"
    optional: true
    decorate: true
    clone_uri: "https://github.com/knative/caching.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--postsubmit-gcs-bucket=knative-prow"
        - "--postsubmit-job-name=post-knative-caching-go-coverage"
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=50"
        - "--github-token=/etc/covbot-token/token"
        volumeMounts:
        - name: covbot-token
          mountPath: /etc/covbot-token
          readOnly: true
      volumes:
      - name: covbot-token
        secret:
          secretName: covbot-token
periodics:
- cron: "1 * * * *"
  name: ci-knative-serving-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=55" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "15 8 * * *"
  name: ci-knative-serving-0.2-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving=release-0.2"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--nopublish"
      - "--notag-release"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: test-account
      secret:
        secretName: test-account
- cron: "20 8 * * *"
  name: ci-knative-serving-0.3-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving=release-0.3"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--nopublish"
      - "--notag-release"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: test-account
      secret:
        secretName: test-account
- cron: "25 8 * * *"
  name: ci-knative-serving-0.4-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving=release-0.4"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--nopublish"
      - "--notag-release"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: test-account
      secret:
        secretName: test-account
- cron: "1 8 * * *"
  name: ci-knative-serving-nightly-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/nightly-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--publish"
      - "--tag-release"
      volumeMounts:
      - name: nightly-account
        mountPath: /etc/nightly-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/nightly-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: nightly-account
      secret:
        secretName: nightly-account
- cron: "1 9 * * 2"
  name: ci-knative-serving-dot-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/release-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--dot-release"
      - "--release-gcs knative-releases/serving"
      - "--release-gcr gcr.io/knative-releases"
      - "--github-token /etc/hub-token/token"
      volumeMounts:
      - name: hub-token
        mountPath: /etc/hub-token
        readOnly: true
      - name: release-account
        mountPath: /etc/release-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/release-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: hub-token
      secret:
        secretName: hub-token
    - name: release-account
      secret:
        secretName: release-account
- cron: "3 */2 * * *"
  name: ci-knative-serving-auto-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/release-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--auto-release"
      - "--release-gcs knative-releases/serving"
      - "--release-gcr gcr.io/knative-releases"
      - "--github-token /etc/hub-token/token"
      volumeMounts:
      - name: hub-token
        mountPath: /etc/hub-token
        readOnly: true
      - name: release-account
        mountPath: /etc/release-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/release-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: hub-token
      secret:
        secretName: hub-token
    - name: release-account
      secret:
        secretName: release-account
- cron: "1 9 * * 6"
  name: ci-knative-serving-playground
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/deploy.sh"
      - "knative-playground"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "5 8 * * *"
  name: ci-knative-serving-latency
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: serving
    base_ref: master
    clone_uri: "https://github.com/knative/serving.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/metrics:latest
      imagePullPolicy: Always
      command:
      - "/metrics"
      args:
      - "--source-directory=ci-knative-serving-continuous"
      - "--artifacts-dir=$(ARTIFACTS)"
      - "--service-account=/etc/test-account/service-account.json"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "5 8 * * *"
  name: ci-knative-serving-api-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: serving
    base_ref: master
    clone_uri: "https://github.com/knative/serving.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/apicoverage:latest
      imagePullPolicy: Always
      command:
      - "/apicoverage"
      args:
      - "--artifacts-dir=$(ARTIFACTS)"
      - "--service-account=/etc/test-account/service-account.json"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-serving-performance
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/serving"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/performance-tests.sh"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-serving-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: serving
    base_ref: master
    clone_uri: "https://github.com/knative/serving.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=80"
- cron: "15 * * * *"
  name: ci-knative-build-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/build"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "31 8 * * *"
  name: ci-knative-build-nightly-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/build"
      - "--root=/go/src"
      - "--service-account=/etc/nightly-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--publish"
      - "--tag-release"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: nightly-account
        mountPath: /etc/nightly-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/nightly-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: nightly-account
      secret:
        secretName: nightly-account
- cron: "7 */2 * * *"
  name: ci-knative-build-auto-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/build"
      - "--root=/go/src"
      - "--service-account=/etc/release-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--auto-release"
      - "--release-gcs knative-releases/build"
      - "--release-gcr gcr.io/knative-releases"
      - "--github-token /etc/hub-token/token"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: hub-token
        mountPath: /etc/hub-token
        readOnly: true
      - name: release-account
        mountPath: /etc/release-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/release-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: hub-token
      secret:
        secretName: hub-token
    - name: release-account
      secret:
        secretName: release-account
- cron: "5 8 * * *"
  name: ci-knative-build-latency
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: build
    base_ref: master
    clone_uri: "https://github.com/knative/build.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/metrics:latest
      imagePullPolicy: Always
      command:
      - "/metrics"
      args:
      - "--source-directory=ci-knative-build-continuous"
      - "--artifacts-dir=$(ARTIFACTS)"
      - "--service-account=/etc/test-account/service-account.json"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-build-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: build
    base_ref: master
    clone_uri: "https://github.com/knative/build.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=80"
- cron: "31 8 * * *"
  name: ci-knative-build-pipeline-nightly-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/build-pipeline"
      - "--root=/go/src"
      - "--service-account=/etc/nightly-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--publish"
      - "--tag-release"
      securityContext:
        privileged: true
      volumeMounts:
      - name: docker-graph
        mountPath: /docker-graph
      - name: nightly-account
        mountPath: /etc/nightly-account
        readOnly: true
      env:
      - name: DOCKER_IN_DOCKER_ENABLED
        value: "true"
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/nightly-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: docker-graph
      emptyDir: {}
    - name: nightly-account
      secret:
        secretName: nightly-account
- cron: "0 1 * * *"
  name: ci-knative-build-pipeline-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: build-pipeline
    base_ref: master
    clone_uri: "https://github.com/knative/build-pipeline.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "50 * * * *"
  name: ci-knative-docs-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/docs"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-docs-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: docs
    base_ref: master
    clone_uri: "https://github.com/knative/docs.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "30 * * * *"
  name: ci-knative-eventing-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/eventing"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "16 9 * * *"
  name: ci-knative-eventing-nightly-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/eventing"
      - "--root=/go/src"
      - "--service-account=/etc/nightly-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--publish"
      - "--tag-release"
      volumeMounts:
      - name: nightly-account
        mountPath: /etc/nightly-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/nightly-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: nightly-account
      secret:
        secretName: nightly-account
- cron: "5 */2 * * *"
  name: ci-knative-eventing-auto-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/eventing"
      - "--root=/go/src"
      - "--service-account=/etc/release-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--auto-release"
      - "--release-gcs knative-releases/eventing"
      - "--release-gcr gcr.io/knative-releases"
      - "--github-token /etc/hub-token/token"
      volumeMounts:
      - name: hub-token
        mountPath: /etc/hub-token
        readOnly: true
      - name: release-account
        mountPath: /etc/release-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/release-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: hub-token
      secret:
        secretName: hub-token
    - name: release-account
      secret:
        secretName: release-account
- cron: "0 1 * * *"
  name: ci-knative-eventing-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: eventing
    base_ref: master
    clone_uri: "https://github.com/knative/eventing.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "30 * * * *"
  name: ci-knative-eventing-sources-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/eventing-sources"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "16 9 * * *"
  name: ci-knative-eventing-sources-nightly-release
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/eventing-sources"
      - "--root=/go/src"
      - "--service-account=/etc/nightly-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=90" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./hack/release.sh"
      - "--publish"
      - "--tag-release"
      volumeMounts:
      - name: nightly-account
        mountPath: /etc/nightly-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/nightly-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: nightly-account
      secret:
        secretName: nightly-account
- cron: "0 1 * * *"
  name: ci-knative-eventing-sources-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: eventing-sources
    base_ref: master
    clone_uri: "https://github.com/knative/eventing-sources.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "40 * * * *"
  name: ci-knative-build-templates-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/build-templates"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "45 * * * *"
  name: ci-knative-pkg-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/pkg"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-pkg-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: pkg
    base_ref: master
    clone_uri: "https://github.com/knative/pkg.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "30 * * * *"
  name: ci-knative-caching-continuous
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      args:
      - "--scenario=kubernetes_execute_bazel"
      - "--clean"
      - "--job=$(JOB_NAME)"
      - "--repo=github.com/knative/caching"
      - "--root=/go/src"
      - "--service-account=/etc/test-account/service-account.json"
      - "--upload=gs://knative-prow/logs"
      - "--timeout=50" # Avoid overrun
      - "--" # end bootstrap args, scenario args below
      - "--" # end kubernetes_execute_bazel flags (consider following flags as text)
      - "./test/presubmit-tests.sh"
      - "--all-tests"
      - "--emit-metrics"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
      env:
      - name: GOOGLE_APPLICATION_CREDENTIALS
        value: /etc/test-account/service-account.json
      - name: E2E_CLUSTER_REGION
        value: us-west1
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "0 1 * * *"
  name: ci-knative-caching-go-coverage
  agent: kubernetes
  decorate: true
  extra_refs:
  - org: knative
    repo: caching
    base_ref: master
    clone_uri: "https://github.com/knative/caching.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/coverage:latest
      imagePullPolicy: Always
      command:
      - "/coverage"
      args:
      - "--artifacts=$(ARTIFACTS)"
      - "--profile-name=coverage_profile.txt"
      - "--cov-target=."
      - "--cov-threshold-percentage=50"
- cron: "0 19 * * 1"
  name: ci-knative-cleanup
  agent: kubernetes
  decorate: true
  decoration_config:
    timeout: 28800000000000 # 8 hours
  extra_refs:
  - org: knative
    repo: test-infra
    base_ref: master
    clone_uri: "https://github.com/knative/test-infra.git"
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/prow-tests:stable
      imagePullPolicy: Always
      command:
      - "./tools/cleanup/cleanup.sh"
      args:
      - "delete-old-gcr-images"
      - "--project-resource-yaml ci/prow/boskos/resources.yaml"
      - "--days-to-keep 30"
      - "--service-account /etc/test-account/service-account.json"
      - "--artifacts $(ARTIFACTS)"
      volumeMounts:
      - name: test-account
        mountPath: /etc/test-account
        readOnly: true
    volumes:
    - name: test-account
      secret:
        secretName: test-account
- cron: "15 9 * * *"
  name: ci-knative-backup-artifacts
  agent: kubernetes
  spec:
    containers:
    - image: gcr.io/knative-tests/test-infra/backups:latest
      imagePullPolicy: Always
      command:
      - "/backup.sh"
      args:
      - "/etc/backup-account/service-account.json"
      volumeMounts:
      - name: backup-account
        mountPath: /etc/backup-account
        readOnly: true
    volumes:
    - name: backup-account
      secret:
        secretName: backup-account
postsubmits:
  knative/serving:
  - name: post-knative-serving-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/serving.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  - name: post-knative-serving-go-coverage-dev
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/serving.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage-dev:latest-dev
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/build:
  - name: post-knative-build-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/build.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/build-pipeline:
  - name: post-knative-build-pipeline-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/build-pipeline.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/eventing:
  - name: post-knative-eventing-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/eventing.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/eventing-sources:
  - name: post-knative-eventing-sources-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/eventing-sources.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/docs:
  - name: post-knative-docs-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/docs.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/pkg:
  - name: post-knative-pkg-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/pkg.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
  knative/caching:
  - name: post-knative-caching-go-coverage
    branches:
    - master
    agent: kubernetes
    decorate: true
    clone_uri: "https://github.com/knative/caching.git"
    spec:
      containers:
      - image: gcr.io/knative-tests/test-infra/coverage:latest
        imagePullPolicy: Always
        command:
        - "/coverage"
        args:
        - "--artifacts=$(ARTIFACTS)"
        - "--profile-name=coverage_profile.txt"
        - "--cov-target=."
        - "--cov-threshold-percentage=0"
