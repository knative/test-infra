# #############################################################################
# ####                                                                     ####
# ####     THIS FILE IS AUTOMATICALLY GENERATED by release-jobs-syncer.    ####
# ####        PLEASE ONLY MODIFY IT MANUALLY WHEN ACTUALLY NEEDED.         ####
# ####                                                                     ####
# #############################################################################
branches:
- release-1.9
image: gcr.io/knative-tests/test-infra/prow-tests:v20230220-8e42b241
jobs:
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --build-tests
  excluded_requirements:
  - gcp
  name: build-tests
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --unit-tests
  excluded_requirements:
  - gcp
  name: unit-tests
  resources: default
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-upgrade-tests.sh
  name: upgrade-tests
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --istio-version latest --no-mesh
  name: istio-latest-no-mesh
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-auto-tls-tests.sh --istio-version latest --no-mesh
  name: istio-latest-no-mesh-tls
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/performance/performance-tests.sh
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: performance-tests-kperf
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/performance/performance-tests-mako.sh
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: performance-tests-mako
  requirements:
  - perf
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --istio-version latest --mesh
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: istio-latest-mesh
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --istio-version latest --mesh --short
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: istio-latest-mesh-short
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-auto-tls-tests.sh --istio-version latest --mesh
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: istio-latest-mesh-tls
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --kourier-version stable
  modifiers:
  - presubmit_skipped
  name: kourier-stable
  regex: ^third_party/kourier-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-auto-tls-tests.sh --kourier-version stable
  modifiers:
  - presubmit_skipped
  name: kourier-stable-tls
  regex: ^third_party/kourier-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --contour-version latest
  modifiers:
  - presubmit_skipped
  name: contour-latest
  regex: ^third_party/contour-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-auto-tls-tests.sh --contour-version latest
  modifiers:
  - presubmit_skipped
  name: contour-tls
  regex: ^third_party/contour-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-internal-encryption-tests.sh --contour-version latest
  modifiers:
  - presubmit_skipped
  name: contour-internal-encryption
  regex: ^third_party/contour-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --gateway-api-version latest
  modifiers:
  - presubmit_skipped
  name: gateway-api-latest
  regex: ^third_party/gateway-api-latest/*
  types:
  - presubmit
- args:
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh --https
  - --run-test
  - ./test/e2e-auto-tls-tests.sh --https
  command:
  - runner.sh
  modifiers:
  - presubmit_optional
  - presubmit_skipped
  name: https
  regex: ^third_party/cert-manager-latest/*
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --all-tests
  name: continuous
  timeout: 3h0m0s
  types:
  - periodic
- args:
  - bash
  - -c
  - |
    mkdir -p /root/.kube
    cat /opt/cluster/ci-script > connect.sh
    chmod +x connect.sh
    server_addr=$(./connect.sh kourier-19)
    kubectl get cm s390x-config-serving -n default -o jsonpath='{.data.adjustment-script}' > adjust.sh
    chmod +x adjust.sh
    ./adjust.sh
    export TEST_OPTIONS=$TEST_OPTIONS' --ingressendpoint '${server_addr}
    ./test/e2e-tests.sh --run-tests --kourier-version latest
  command:
  - runner.sh
  cron: 20 14 * * *
  env:
  - name: SYSTEM_NAMESPACE
    value: knative-serving
  - name: TEST_OPTIONS
    value: --enable-alpha --enable-beta --resolvabledomain=false
  name: s390x-kourier-tests
  requirements:
  - s390x
  types:
  - periodic
- args:
  - bash
  - -c
  - |
    mkdir -p /root/.kube
    cat /opt/cluster/ci-script > connect.sh
    chmod +x connect.sh
    server_addr=$(./connect.sh contour-19)
    kubectl get cm s390x-config-serving -n default -o jsonpath='{.data.adjustment-script}' > adjust.sh
    chmod +x adjust.sh
    ./adjust.sh
    export TEST_OPTIONS=$TEST_OPTIONS' --ingressendpoint '${server_addr}
    ./test/e2e-tests.sh --run-tests --contour-version latest
  command:
  - runner.sh
  cron: 20 15 * * *
  env:
  - name: SYSTEM_NAMESPACE
    value: knative-serving
  - name: TEST_OPTIONS
    value: --enable-alpha --enable-beta --resolvabledomain=false
  name: s390x-contour-tests
  requirements:
  - s390x
  types:
  - periodic
- args:
  - bash
  - -c
  - |
    cat /opt/cluster/ci-script > /tmp/connect.sh
    chmod +x /tmp/connect.sh
    . /tmp/connect.sh ${CI_JOB}
    export TEST_OPTIONS=$TEST_OPTIONS' --ingressendpoint 'cluster.ppc64le
    ./test/e2e-tests.sh --run-tests --kourier-version latest
  command:
  - runner.sh
  cron: 0 8 * * *
  env:
  - name: SYSTEM_NAMESPACE
    value: knative-serving
  - name: TEST_OPTIONS
    value: --enable-alpha --enable-beta --resolvabledomain=false
  - name: CI_JOB
    value: kourier-release-1.9
  name: ppc64le-kourier-tests
  requirements:
  - ppc64le
  types:
  - periodic
- args:
  - bash
  - -c
  - |
    cat /opt/cluster/ci-script > /tmp/connect.sh
    chmod +x /tmp/connect.sh
    . /tmp/connect.sh ${CI_JOB}
    export TEST_OPTIONS=$TEST_OPTIONS' --ingressendpoint 'cluster.ppc64le
    ./test/e2e-tests.sh --run-tests --contour-version latest
  command:
  - runner.sh
  cron: 0 15 * * *
  env:
  - name: SYSTEM_NAMESPACE
    value: knative-serving
  - name: TEST_OPTIONS
    value: --enable-alpha --enable-beta --resolvabledomain=false
  - name: CI_JOB
    value: contour-release-1.9
  name: ppc64le-contour-tests
  requirements:
  - ppc64le
  types:
  - periodic
- command:
  - runner.sh
  - ./hack/release.sh
  - --dot-release
  - --release-gcs
  - knative-releases/serving
  - --release-gcr
  - gcr.io/knative-releases
  - --github-token
  - /etc/hub-token/token
  - --branch
  - release-1.9
  excluded_requirements:
  - gcp
  max_concurrency: 1
  name: release
  requirements:
  - release
  timeout: 3h0m0s
  types:
  - periodic
org: knative
repo: serving
requirement_presets:
  gcp:
    env:
    - name: E2E_CLUSTER_REGION
      value: us-central1
    podSpec:
      containers: null
      serviceAccountName: test-runner
  nightly:
    env:
    - name: GOOGLE_APPLICATION_CREDENTIALS
      value: /etc/nightly-account/service-account.json
    podSpec:
      containers: null
      serviceAccountName: nightly
    volumeMounts:
    - mountPath: /etc/nightly-account
      name: nightly-account
      readOnly: true
    volumes:
    - name: nightly-account
      secret:
        items:
        - key: nightly.json
          path: service-account.json
        secretName: prow-google-credentials
  perf:
    podSpec:
      containers: null
      serviceAccountName: test-runner
    volumeMounts:
    - mountPath: /etc/influx-token-secret-volume
      name: influx-token-secret-volume
      readOnly: true
    - mountPath: /etc/influx-url-secret-volume
      name: influx-url-secret-volume
      readOnly: true
    volumes:
    - name: influx-token-secret-volume
      secret:
        defaultMode: 384
        secretName: influx-token-secret
    - name: influx-url-secret-volume
      secret:
        defaultMode: 384
        secretName: influx-url-secret
  release:
    env:
    - name: E2E_CLUSTER_REGION
      value: us-central1
    podSpec:
      containers: null
      serviceAccountName: release
    volumeMounts:
    - mountPath: /etc/hub-token
      name: hub-token
      readOnly: true
    volumes:
    - name: hub-token
      secret:
        items:
        - key: hub_token
          path: token
        secretName: github-credentials
    - name: release-account
      secret:
        items:
        - key: release.json
          path: service-account.json
        secretName: prow-google-credentials
requirements:
- docker
resources: high
resources_presets:
  default:
    limits:
      memory: 10Gi
    requests:
      memory: 8Gi
  high:
    limits:
      memory: 16Gi
    requests:
      memory: 12Gi
