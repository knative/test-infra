org: knative-sandbox
repo: kn-plugin-operator
branches: [main]
image: us-docker.pkg.dev/knative-tests/images/prow-tests:v20230605-5de90de6

jobs:
  - name: build-tests
    types: [presubmit]
    command: [runner.sh, ./test/presubmit-tests.sh, --build-tests]
    excluded_requirements: [gcp]

  - name: unit-tests
    types: [presubmit]
    command: [runner.sh, ./test/presubmit-tests.sh, --unit-tests]
    excluded_requirements: [gcp]

  - name: integration-tests
    types: [presubmit]
    command: [runner.sh, ./test/presubmit-tests.sh, --integration-tests]

  - name: continuous
    types: [periodic]
    command: [runner.sh, ./test/presubmit-tests.sh, --all-tests]

  - name: nightly
    types: [periodic]
    command: [runner.sh, ./hack/release.sh, --publish, --tag-release,
      --apple-codesign-key, /etc/notary/cert.p12,
      --apple-notary-api-key, /etc/notary/key.json,
      --apple-codesign-password-file, /etc/notary/password]
    requirements: [nightly-notary]
    excluded_requirements: [gcp]

  - name: release
    types: [periodic]
    command: [runner.sh, ./hack/release.sh, --auto-release, --release-gcs, knative-releases/kn-plugin-operator, --release-gcr, gcr.io/knative-releases, --github-token, /etc/hub-token/token,
      --apple-codesign-key, /etc/notary/cert.p12,
      --apple-notary-api-key, /etc/notary/key.json,
      --apple-codesign-password-file, /etc/notary/password]
    requirements: [release-notary]
    excluded_requirements: [gcp]
