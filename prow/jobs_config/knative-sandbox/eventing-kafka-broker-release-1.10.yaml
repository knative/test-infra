# #############################################################################
# ####                                                                     ####
# ####     THIS FILE IS AUTOMATICALLY GENERATED by release-jobs-syncer.    ####
# ####        PLEASE ONLY MODIFY IT MANUALLY WHEN ACTUALLY NEEDED.         ####
# ####                                                                     ####
# #############################################################################
branches:
- release-1.10
image: gcr.io/knative-tests/test-infra/prow-tests:v20230524-d6a12e8c
jobs:
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --build-tests
  excluded_requirements:
  - gcp
  name: build-tests
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --unit-tests
  excluded_requirements:
  - gcp
  name: unit-tests
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --integration-tests
  env:
  - name: BROKER_CLASS
    value: Kafka
  name: integration-tests
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/upgrade-tests.sh
  env:
  - name: BROKER_CLASS
    value: Kafka
  name: upgrade-tests
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/reconciler-tests.sh
  env:
  - name: BROKER_CLASS
    value: Kafka
  name: reconciler-tests
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/reconciler-tests.sh
  env:
  - name: BROKER_CLASS
    value: KafkaNamespaced
  name: reconciler-tests-namespaced-broker
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SSL
  - name: BROKER_CLASS
    value: Kafka
  name: channel-integration-tests-ssl
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SASL_SSL
  - name: BROKER_CLASS
    value: Kafka
  name: channel-integration-tests-sasl-ssl
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/e2e-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SASL_PLAIN
  - name: BROKER_CLASS
    value: Kafka
  name: channel-integration-tests-sasl-plain
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/reconciler-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SSL
  - name: BROKER_CLASS
    value: Kafka
  name: channel-reconciler-tests-ssl
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/reconciler-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SASL_SSL
  - name: BROKER_CLASS
    value: Kafka
  name: channel-reconciler-tests-sasl-ssl
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --run-test
  - ./test/reconciler-tests.sh
  env:
  - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
    value: SASL_PLAIN
  - name: BROKER_CLASS
    value: Kafka
  name: channel-reconciler-tests-sasl-plain
  requirements:
  - docker
  types:
  - presubmit
- command:
  - runner.sh
  - ./test/presubmit-tests.sh
  - --all-tests
  env:
  - name: BROKER_CLASS
    value: Kafka
  name: continuous
  requirements:
  - docker
  types:
  - periodic
- command:
  - runner.sh
  - ./hack/release.sh
  - --dot-release
  - --release-gcs
  - knative-releases/eventing-kafka-broker
  - --release-gcr
  - gcr.io/knative-releases
  - --github-token
  - /etc/hub-token/token
  - --branch
  - release-1.10
  env:
  - name: BROKER_CLASS
    value: Kafka
  excluded_requirements:
  - gcp
  max_concurrency: 1
  name: release
  requirements:
  - release
  - docker
  types:
  - periodic
- name: s390x-e2e-tests-ssl
  cron: 20 11 * * *
  types: [periodic]
  requirements: [s390x]
  command: [runner.sh]
  args:
    - bash
    - -c
    - |
      mkdir -p /root/.kube
      cat /opt/cluster/ci-script > connect.sh
      chmod +x connect.sh
      ./connect.sh eventing_kafka-broker-ssl-110
      kubectl get cm s390x-config-eventing-kafka-broker -n default -o jsonpath='{.data.adjustment-script}' > adjust.sh
      chmod +x adjust.sh
      ./adjust.sh
      ./test/e2e-tests.sh --run-tests
  env:
    - name: SYSTEM_NAMESPACE
      value: knative-eventing
    - name: EVENTING_NAMESPACE
      value: knative-eventing
    - name: SCALE_CHAOSDUCK_TO_ZERO
      value: "1"
    - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
      value: SSL
    - name: BROKER_CLASS
      value: Kafka
- name: s390x-e2e-tests-sasl-ssl
  cron: 20 12 * * *
  types: [periodic]
  requirements: [s390x]
  command: [runner.sh]
  args:
    - bash
    - -c
    - |
      mkdir -p /root/.kube
      cat /opt/cluster/ci-script > connect.sh
      chmod +x connect.sh
      ./connect.sh eventing_kafka-broker-sasl-ssl-110
      kubectl get cm s390x-config-eventing-kafka-broker -n default -o jsonpath='{.data.adjustment-script}' > adjust.sh
      chmod +x adjust.sh
      ./adjust.sh
      ./test/e2e-tests.sh --run-tests
  env:
    - name: SYSTEM_NAMESPACE
      value: knative-eventing
    - name: EVENTING_NAMESPACE
      value: knative-eventing
    - name: SCALE_CHAOSDUCK_TO_ZERO
      value: "1"
    - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
      value: SASL_SSL
    - name: BROKER_CLASS
      value: Kafka
- name: s390x-e2e-tests-sasl-plain
  cron: 20 13 * * *
  types: [periodic]
  requirements: [s390x]
  command: [runner.sh]
  args:
    - bash
    - -c
    - |
      mkdir -p /root/.kube
      cat /opt/cluster/ci-script > connect.sh
      chmod +x connect.sh
      ./connect.sh eventing_kafka-broker-sasl-plain-110
      kubectl get cm s390x-config-eventing-kafka-broker -n default -o jsonpath='{.data.adjustment-script}' > adjust.sh
      chmod +x adjust.sh
      ./adjust.sh
      ./test/e2e-tests.sh --run-tests
  env:
    - name: SYSTEM_NAMESPACE
      value: knative-eventing
    - name: EVENTING_NAMESPACE
      value: knative-eventing
    - name: SCALE_CHAOSDUCK_TO_ZERO
      value: "1"
    - name: EVENTING_KAFKA_BROKER_CHANNEL_AUTH_SCENARIO
      value: SASL_PLAIN
    - name: BROKER_CLASS
      value: Kafka
org: knative-sandbox
repo: eventing-kafka-broker
